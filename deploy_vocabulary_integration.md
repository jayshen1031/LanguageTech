# 词汇整合云函数部署指南

## 问题描述
首页显示错误："加载词汇统计失败: Error: errCode: -502005 database collection not exists"
这是因为 `vocabulary-integration` 云函数尚未部署，需要先部署此云函数才能创建 `vocabulary_integrated` 数据表。

## 解决方案

### 方法1：微信开发者工具部署（推荐）

1. **打开微信开发者工具**
   - 确保已打开 LanguageTech 项目

2. **部署云函数**
   - 在左侧文件树中找到 `cloudfunctions/vocabulary-integration/` 文件夹
   - 右键点击 `vocabulary-integration` 文件夹
   - 选择"上传并部署：云端安装依赖"
   - 等待部署完成（通常需要1-2分钟）

3. **验证部署**
   - 部署成功后，在控制台应该看到"上传成功"提示
   - 在云开发控制台的"云函数"页面应该能看到 `vocabulary-integration` 函数

### 方法2：命令行部署（备选）

如果开发者工具部署失败，可以尝试命令行方式：

```bash
# 进入项目目录
cd /Users/jay/Documents/baidu/projects/LanguageTech

# 使用微信开发者工具CLI（如果已配置）
miniprogram-cli cloud-functions:deploy vocabulary-integration
```

## 部署后验证

部署成功后，请执行以下验证步骤：

1. **重新打开小程序首页**
   - 应该不再显示词汇统计加载错误

2. **测试词汇整合功能**
   - 如果之前有解析历史，首页应该弹出词汇整合提示
   - 点击"立即整合"应该能成功创建词汇库

3. **检查数据库**
   - 在云开发控制台数据库页面
   - 应该能看到新创建的 `vocabulary_integrated` 集合

## 故障排除

### 如果部署失败：

1. **检查网络连接**
   - 确保网络畅通
   - 尝试切换网络环境

2. **检查云开发环境**
   - 确认云环境ID是否正确：`cloud1-2g49srond2b01891`
   - 确认云开发服务是否正常

3. **检查依赖包**
   - 确认 `package.json` 文件存在且格式正确
   - 依赖包：`wx-server-sdk: ~2.6.3`

4. **重新尝试**
   - 删除云函数重新创建
   - 或者直接在开发者工具中重新上传

## 成功标志

✅ 部署成功后，首页应该显示正确的词汇统计：
- 总词汇量: X个
- 新词汇: X个  
- 复习词汇: X个

✅ 学习计划功能正常工作
✅ 不再出现数据库集合不存在的错误

---

**注意事项：**
- 首次部署后需要有解析历史数据才能看到词汇统计
- 如果没有解析历史，建议先去"日语解析"页面解析一些内容
- 词汇整合是自动进行的，每次新增解析都会自动整合到词汇库