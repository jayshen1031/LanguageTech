<!-- pages/admin/import-n2.wxml -->
<view class="container">
  <view class="header">
    <text class="title">N2词汇导入工具</text>
    <text class="subtitle">批量导入2000个JLPT N2级别词汇</text>
  </view>

  <!-- 状态卡片 -->
  <view class="status-card">
    <view class="status-row">
      <text class="status-label">当前状态：</text>
      <text class="status-value {{importing ? 'importing' : ''}}">{{statusMessage}}</text>
    </view>
    
    <view class="status-row">
      <text class="status-label">导入进度：</text>
      <text class="status-value">{{importedCount}} / {{totalVocabulary}}</text>
    </view>
    
    <view class="status-row" wx:if="{{failedCount > 0}}">
      <text class="status-label">失败数量：</text>
      <text class="status-value error">{{failedCount}}</text>
    </view>
    
    <!-- 进度条 -->
    <view class="progress-container">
      <progress percent="{{currentProgress}}" show-info stroke-width="12" 
                activeColor="{{failedCount > 0 ? '#FFA500' : '#07c160'}}" />
    </view>
    
    <view class="segment-info" wx:if="{{importing}}">
      <text>正在处理第 {{currentSegment}} / {{totalSegments}} 段</text>
    </view>
  </view>

  <!-- 操作按钮 -->
  <view class="button-group">
    <button class="btn-primary" bindtap="startSegmentedImport" 
            disabled="{{importing}}" loading="{{importing}}">
      {{importing ? '正在导入...' : '开始分段导入'}}
    </button>
    
    <button class="btn-secondary" bindtap="checkImportStatus" 
            disabled="{{importing}}">
      刷新状态
    </button>
    
    <button class="btn-danger" bindtap="stopImport" 
            wx:if="{{importing}}">
      停止导入
    </button>
    
    <button class="btn-danger" bindtap="clearAllVocabulary" 
            disabled="{{importing}}">
      清空所有词汇
    </button>
  </view>

  <!-- 导入说明 -->
  <view class="info-card">
    <view class="info-title">导入说明</view>
    <view class="info-content">
      <text>• 总词汇量：2000个N2级别词汇</text>
      <text>• 分段导入：每段100个词汇，共20段</text>
      <text>• 预计时间：5-10分钟</text>
      <text>• 失败重试：自动跳过失败项继续</text>
      <text>• 网络要求：需要稳定的网络连接</text>
    </view>
  </view>

  <!-- 日志区域 -->
  <view class="log-card" wx:if="{{logs.length > 0}}">
    <view class="log-title">导入日志</view>
    <scroll-view class="log-content" scroll-y>
      <view class="log-item {{item.type}}" wx:for="{{logs}}" wx:key="index">
        <text class="log-time">[{{item.time}}]</text>
        <text class="log-message">{{item.message}}</text>
      </view>
    </scroll-view>
  </view>

  <!-- 返回按钮 -->
  <view class="footer">
    <button class="btn-back" bindtap="goBack">返回</button>
  </view>
</view>