<!-- 批量导入词汇页面 -->
<view class="container">
  <view class="header">
    <text class="title">批量导入词汇</text>
    <text class="subtitle">支持 JSON、CSV、TXT 格式文件</text>
  </view>

  <!-- 文件选择区域 -->
  <view class="upload-section">
    <view class="upload-box" bindtap="chooseFile">
      <van-icon name="plus" size="32px" color="#999" />
      <text class="upload-text">{{fileName || '点击选择文件'}}</text>
    </view>
    
    <view class="format-tips">
      <text class="tips-title">支持的格式：</text>
      <view class="format-item">
        <text class="format-type">JSON：</text>
        <text class="format-desc">完整结构化数据</text>
      </view>
      <view class="format-item">
        <text class="format-type">CSV：</text>
        <text class="format-desc">表格格式数据</text>
      </view>
      <view class="format-item">
        <text class="format-type">TXT：</text>
        <text class="format-desc">简单文本格式</text>
      </view>
    </view>
  </view>

  <!-- 预览区域 -->
  <view class="preview-section" wx:if="{{previewData.length > 0}}">
    <view class="section-title">
      <text>数据预览</text>
      <text class="count">共 {{totalCount}} 个词汇</text>
    </view>
    
    <scroll-view scroll-y class="preview-list">
      <view class="preview-item" wx:for="{{previewData}}" wx:key="index">
        <view class="word-info">
          <text class="word">{{item.word}}</text>
          <text class="kana">{{item.kana || item.reading}}</text>
          <text class="meaning">{{item.meaning || (item.meanings && item.meanings[0])}}</text>
        </view>
        <text class="type">{{item.type || item.partOfSpeech}}</text>
      </view>
    </scroll-view>
    
    <view class="preview-more" wx:if="{{totalCount > 5}}">
      <text>... 还有 {{totalCount - 5}} 个词汇</text>
    </view>
  </view>

  <!-- 导入选项 -->
  <view class="import-options" wx:if="{{previewData.length > 0}}">
    <view class="option-item">
      <text>清空现有词汇</text>
      <switch checked="{{clearExisting}}" bindchange="onClearOptionChange" />
    </view>
    <view class="option-item">
      <text>自动生成标签</text>
      <switch checked="{{autoGenerateTags}}" bindchange="onTagsOptionChange" />
    </view>
  </view>

  <!-- 导入进度 -->
  <view class="progress-section" wx:if="{{importing}}">
    <view class="progress-bar">
      <view class="progress-fill" style="width: {{progress}}%"></view>
    </view>
    <text class="progress-text">导入中... {{importedCount}}/{{totalCount}}</text>
    <view class="progress-stats">
      <text class="success">成功: {{successCount}}</text>
      <text class="failed">失败: {{failedCount}}</text>
    </view>
  </view>

  <!-- 导入结果 -->
  <view class="result-section" wx:if="{{importComplete}}">
    <van-icon name="{{failedCount > 0 ? 'warning' : 'success'}}" 
              size="48px" 
              color="{{failedCount > 0 ? '#ff976a' : '#07c160'}}" />
    <text class="result-title">导入{{failedCount > 0 ? '完成' : '成功'}}</text>
    <view class="result-stats">
      <text>成功导入: {{successCount}} 个</text>
      <text wx:if="{{failedCount > 0}}">失败: {{failedCount}} 个</text>
    </view>
  </view>

  <!-- 错误列表 -->
  <view class="error-section" wx:if="{{errors.length > 0}}">
    <text class="section-title">错误详情</text>
    <scroll-view scroll-y class="error-list">
      <view class="error-item" wx:for="{{errors}}" wx:key="index">
        <text class="error-word">{{item.word}}</text>
        <text class="error-msg">{{item.error}}</text>
      </view>
    </scroll-view>
  </view>

  <!-- 操作按钮 -->
  <view class="button-group">
    <van-button 
      wx:if="{{!importing && !importComplete && previewData.length > 0}}"
      type="primary" 
      block 
      bindtap="startImport">
      开始导入
    </van-button>
    
    <van-button 
      wx:if="{{importing}}"
      type="danger" 
      block 
      bindtap="stopImport">
      停止导入
    </van-button>
    
    <van-button 
      wx:if="{{importComplete}}"
      type="primary" 
      block 
      bindtap="resetImport">
      继续导入
    </van-button>
    
    <van-button 
      wx:if="{{importComplete}}"
      plain 
      block 
      bindtap="goToLearn">
      前往学习
    </van-button>
  </view>
</view>