<view class="container">
  <!-- å­¦ä¹ è®¾ç½®ï¼ˆé¦–æ¬¡åŠ è½½æ—¶æ˜¾ç¤ºï¼‰ -->
  <view class="setup-modal" wx:if="{{showSetup}}">
    <view class="setup-content">
      <text class="setup-title">ä»Šå¤©æƒ³å­¦ä¹ å¤šå°‘ä¸ªå•è¯ï¼Ÿ</text>
      <view class="word-count-options">
        <button class="count-option" bindtap="selectWordCount" data-count="5">5ä¸ª</button>
        <button class="count-option" bindtap="selectWordCount" data-count="10">10ä¸ª</button>
        <button class="count-option" bindtap="selectWordCount" data-count="15">15ä¸ª</button>
        <button class="count-option" bindtap="selectWordCount" data-count="20">20ä¸ª</button>
      </view>
      <text class="setup-tip">å»ºè®®æ¯å¤©å­¦ä¹ 10-15ä¸ªæ–°è¯</text>
    </view>
  </view>

  <!-- å­¦ä¹ è¿›åº¦ -->
  <view class="progress-header" wx:if="{{!showSetup}}">
    <text class="progress-text">{{currentIndex + 1}} / {{wordList.length}}</text>
    <view class="progress-dots">
      <view 
        wx:for="{{wordList}}" 
        wx:key="id"
        class="dot {{index <= currentIndex ? 'active' : ''}}"
      ></view>
    </view>
  </view>

  <!-- å•è¯å¡ç‰‡ -->
  <view class="word-card-wrapper">
    <view class="word-card" bindtap="playAudio">
      <view class="word-main">
        <text class="word-text">{{currentWord.word}}</text>
        <view class="word-kana">
          <text>{{currentWord.kana}}</text>
          <text class="romaji">{{currentWord.romaji}}</text>
        </view>
      </view>
      
      <view class="divider"></view>
      
      <view class="word-meaning">
        <text class="meaning-text">{{currentWord.meaning}}</text>
        <view class="word-meta">
          <text class="word-type">{{currentWord.type}}</text>
          <text class="word-level">{{currentWord.level}}</text>
          <text class="word-source" wx:if="{{currentWord.source === 'history'}}">è§£æè¯æ±‡</text>
        </view>
      </view>
      
      <!-- ä¾‹å¥éƒ¨åˆ† -->
      <view class="example-section" wx:if="{{currentWord.examples && currentWord.examples.length > 0}}">
        <text class="example-title">ä¾‹å¥ï¼š</text>
        <view class="example-item" wx:for="{{currentWord.examples}}" wx:key="index">
          <text class="example-jp">{{item.jp}}</text>
          <text class="example-cn">{{item.cn}}</text>
        </view>
        
        <!-- è¯­æ³•ä¿¡æ¯ -->
        <view wx:if="{{currentWord.grammar || currentWord.structure || currentWord.analysis}}" class="grammar-section">
          <view wx:if="{{currentWord.structure}}" class="grammar-item">
            <text class="grammar-label">å¥å­ç»“æ„ï¼š</text>
            <text class="grammar-content">{{currentWord.structure}}</text>
          </view>
          
          <view wx:if="{{currentWord.grammar}}" class="grammar-item">
            <text class="grammar-label">è¯­æ³•è¦ç‚¹ï¼š</text>
            <text class="grammar-content">{{currentWord.grammar}}</text>
          </view>
          
          <view wx:if="{{currentWord.analysis}}" class="grammar-item">
            <text class="grammar-label">è¯¦ç»†è§£æï¼š</text>
            <text class="grammar-content">{{currentWord.analysis}}</text>
          </view>
        </view>
      </view>
      
      <!-- æ— ä¾‹å¥æç¤º -->
      <view class="example-section" wx:if="{{!currentWord.examples || currentWord.examples.length === 0}}">
        <text class="example-title">ä¾‹å¥ï¼š</text>
        <text class="no-example-hint">æš‚æ— ä¾‹å¥</text>
      </view>
      
      <view class="audio-hint">
        <text>ğŸ”Š ç‚¹å‡»å¡ç‰‡æ’­æ”¾è¯­éŸ³</text>
      </view>
    </view>
  </view>

  <!-- ç¿»é¡µæŒ‰é’® -->
  <view class="nav-buttons">
    <button class="btn-nav" bindtap="prevWord" disabled="{{currentIndex === 0}}">
      ä¸Šä¸€ä¸ª
    </button>
    <button class="btn-nav" bindtap="nextWord" disabled="{{currentIndex >= wordList.length - 1}}">
      ä¸‹ä¸€ä¸ª
    </button>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn-action" bindtap="toggleExample">
      {{showExample ? 'éšè—ä¾‹å¥' : 'æ˜¾ç¤ºä¾‹å¥'}}
    </button>
    <button class="btn-action" bindtap="addToWordbook">
      <text class="{{inWordbook ? 'added' : ''}}">{{inWordbook ? 'å·²æ·»åŠ ' : 'åŠ å…¥ç”Ÿè¯æœ¬'}}</text>
    </button>
  </view>

  <!-- æŒæ¡çŠ¶æ€æŒ‰é’® -->
  <view class="master-buttons">
    <button class="btn-master forgot" bindtap="markStatus" data-status="forgot">
      <text class="icon">ğŸ˜•</text>
      <text>ä¸è®¤è¯†</text>
    </button>
    <button class="btn-master fuzzy" bindtap="markStatus" data-status="fuzzy">
      <text class="icon">ğŸ¤”</text>
      <text>æ¨¡ç³Š</text>
    </button>
    <button class="btn-master mastered" bindtap="markStatus" data-status="mastered">
      <text class="icon">ğŸ˜Š</text>
      <text>æŒæ¡</text>
    </button>
  </view>

  <!-- å®Œæˆæç¤º -->
  <view class="complete-modal" wx:if="{{showComplete}}">
    <view class="modal-content">
      <text class="complete-title">ğŸ‰ ä»Šæ—¥å­¦ä¹ å®Œæˆï¼</text>
      <text class="complete-desc">ä½ å·²ç»å­¦ä¹ äº† {{wordList.length}} ä¸ªæ–°è¯</text>
      <view class="complete-stats">
        <view class="stat-item">
          <text class="stat-label">æŒæ¡</text>
          <text class="stat-value">{{masteredCount}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">æ¨¡ç³Š</text>
          <text class="stat-value">{{fuzzyCount}}</text>
        </view>
        <view class="stat-item">
          <text class="stat-label">ä¸è®¤è¯†</text>
          <text class="stat-value">{{forgotCount}}</text>
        </view>
      </view>
      <button class="btn-primary" bindtap="goBack">è¿”å›é¦–é¡µ</button>
    </view>
  </view>
</view>