<!-- 用户注册页面 -->
<view class="container">
  <!-- 未登录状态 -->
  <view wx:if="{{!isLoggedIn}}" class="login-section">
    <view class="welcome-header">
      <image class="app-logo" src="/images/learn-active.png" mode="aspectFit"></image>
      <text class="welcome-title">欢迎使用语伴君</text>
      <text class="welcome-subtitle">AI驱动的智能日语学习助手</text>
    </view>
    
    <view class="login-card">
      <view class="login-benefits">
        <view class="benefit-item">
          <text class="benefit-icon">📚</text>
          <text class="benefit-text">个性化学习计划</text>
        </view>
        <view class="benefit-item">
          <text class="benefit-icon">☁️</text>
          <text class="benefit-text">学习记录云端同步</text>
        </view>
        <view class="benefit-item">
          <text class="benefit-icon">📊</text>
          <text class="benefit-text">详细学习统计</text>
        </view>
        <view class="benefit-item">
          <text class="benefit-icon">🎯</text>
          <text class="benefit-text">智能复习提醒</text>
        </view>
      </view>
      
      <!-- 主要登录方式 -->
      <button class="phone-login-btn" bindtap="goToPhoneLogin">
        <text class="phone-icon">📱</text>
        手机号登录
      </button>
      
      <!-- 其他登录方式 -->
      <view class="other-login">
        <button class="wechat-login-btn" bindtap="onWechatLogin">
          <text class="wechat-icon">👤</text>
          微信登录
        </button>
        
        <text class="skip-text" bindtap="onSkipRegister">暂时跳过</text>
      </view>
    </view>
  </view>

  <!-- 已登录但未完善资料 -->
  <view wx:elif="{{isLoggedIn && !hasUserProfile}}" class="profile-section">
    <view class="profile-header">
      <!-- 如果已有微信头像，直接显示；否则显示选择按钮 -->
      <view wx:if="{{userInfo.avatarUrl}}" class="avatar-display">
        <image class="user-avatar" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
        <view class="avatar-tip">微信头像</view>
      </view>
      <button wx:else class="avatar-button" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
        <image class="user-avatar" src="/images/default-avatar.png" mode="aspectFill"></image>
        <view class="avatar-tip">点击选择头像</view>
      </button>
      <text class="profile-title">完善个人资料</text>
      <text class="profile-subtitle">让学习更加个性化</text>
    </view>
    
    <view class="form-card">
      <view class="form-group">
        <text class="label">昵称</text>
        <input class="input" type="nickname" placeholder="请输入您的昵称" value="{{nickname}}" bindinput="onNicknameInput" maxlength="20" />
      </view>
      
      <view class="form-group">
        <text class="label">学习目标</text>
        <radio-group bindchange="onLearningGoalChange">
          <view class="radio-list">
            <label class="radio-item">
              <radio value="daily" checked="{{learningGoal === 'daily'}}" color="#4A90E2" />
              <text class="radio-text">日常交流</text>
            </label>
            <label class="radio-item">
              <radio value="exam" checked="{{learningGoal === 'exam'}}" color="#4A90E2" />
              <text class="radio-text">考试备考</text>
            </label>
            <label class="radio-item">
              <radio value="business" checked="{{learningGoal === 'business'}}" color="#4A90E2" />
              <text class="radio-text">商务日语</text>
            </label>
            <label class="radio-item">
              <radio value="travel" checked="{{learningGoal === 'travel'}}" color="#4A90E2" />
              <text class="radio-text">旅游日语</text>
            </label>
          </view>
        </radio-group>
      </view>
      
      <view class="form-group">
        <text class="label">每日学习时间</text>
        <slider bindchange="onStudyTimeChange" value="{{studyTimePerDay}}" min="10" max="120" step="10" show-value color="#4A90E2" />
        <text class="slider-unit">分钟</text>
      </view>
      
      <view class="form-group">
        <text class="label">当前水平</text>
        <radio-group bindchange="onLevelChange">
          <view class="radio-list horizontal">
            <label class="radio-item">
              <radio value="beginner" checked="{{currentLevel === 'beginner'}}" color="#4A90E2" />
              <text class="radio-text">初学者</text>
            </label>
            <label class="radio-item">
              <radio value="intermediate" checked="{{currentLevel === 'intermediate'}}" color="#4A90E2" />
              <text class="radio-text">中级</text>
            </label>
            <label class="radio-item">
              <radio value="advanced" checked="{{currentLevel === 'advanced'}}" color="#4A90E2" />
              <text class="radio-text">高级</text>
            </label>
          </view>
        </radio-group>
      </view>
      
      <!-- 服务条款确认 -->
      <view class="terms-section">
        <checkbox-group bindchange="onTermsChange">
          <label class="checkbox-wrapper">
            <checkbox value="agree" checked="{{agreedToTerms}}" color="#4A90E2" />
            <text class="checkbox-text">我已阅读并同意</text>
            <text class="link-text" bindtap="showUserAgreement">《用户协议》</text>
            <text class="checkbox-text">和</text>
            <text class="link-text" bindtap="showPrivacyPolicy">《隐私政策》</text>
          </label>
        </checkbox-group>
      </view>
      
      <button class="complete-btn" bindtap="onCompleteProfile" disabled="{{!agreedToTerms}}">
        提交申请
      </button>
      
      <view class="register-tips">
        <text class="tip-text">• 提交后需要审核，通常1-3个工作日</text>
        <text class="tip-text">• 请确保信息真实有效</text>
        <text class="tip-text">• 审核结果将及时通知</text>
      </view>
    </view>
  </view>

  <!-- 已登录且已完善资料 -->
  <view wx:else class="profile-management">
    <view class="user-info-header">
      <image class="user-avatar-large" src="{{userInfo.avatarUrl}}" mode="aspectFill"></image>
      <view class="user-details">
        <text class="user-nickname">{{nickname}}</text>
        <text class="user-goal">{{learningGoal === 'daily' ? '日常交流' : learningGoal === 'exam' ? '考试备考' : learningGoal === 'business' ? '商务日语' : '旅游日语'}}</text>
        <text class="user-level">{{currentLevel === 'beginner' ? '初学者' : currentLevel === 'intermediate' ? '中级' : '高级'}}</text>
      </view>
    </view>
    
    <view class="profile-stats">
      <view class="stat-item">
        <text class="stat-number">{{studyTimePerDay}}</text>
        <text class="stat-label">分钟/天</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-number">5</text>
        <text class="stat-label">学习天数</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item">
        <text class="stat-number">126</text>
        <text class="stat-label">掌握词汇</text>
      </view>
    </view>
    
    <view class="action-buttons">
      <button class="edit-profile-btn" bindtap="onCompleteProfile">修改资料</button>
      <button class="logout-btn" bindtap="onLogout">退出登录</button>
    </view>
  </view>
</view>